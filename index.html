<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Poppins',sans-serif;background:linear-gradient(270deg,#6f00ff,#c800ff,#6c63ff,#3498db);background-size:800% 800%;animation:gradientBG 25s ease infinite;color:#fff;min-height:100vh;}
@keyframes gradientBG{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
.container{max-width:900px;margin:50px auto;padding:20px;background:rgba(0,0,0,0.8);border-radius:20px;box-shadow:0 20px 50px rgba(0,0,0,0.7);}
h2{text-align:center;font-size:28px;text-shadow:0 0 15px #6c63ff,0 0 25px #ff00ff;margin-bottom:20px;}
input{width:100%;padding:14px;border-radius:12px;border:2px solid #6c63ff;background: rgba(0,0,0,0.3);color:#fff;font-size:16px;margin-bottom:20px;}
input:focus{border-color:#ff00ff;outline:none;box-shadow:0 0 30px #ff00ff,0 0 50px #6c63ff inset;}
button{padding:10px 20px;border:none;border-radius:15px;background: linear-gradient(90deg,#6c63ff,#ff00ff,#6c63ff);color:#fff;font-size:16px;cursor:pointer;margin-bottom:20px;}
button:hover{box-shadow:0 0 30px #ff00ff,0 0 60px #6c63ff inset;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{padding:10px;text-align:left;border-bottom:1px solid #fff;}
th{text-shadow:0 0 5px #fff;}
</style>
</head>
<body>
<div class="container" id="loginContainer">
  <h2>Admin Login</h2>
  <input type="password" id="adminPassword" placeholder="Masukkan Password Admin">
  <button id="loginBtn">Login</button>
</div>

<div class="container" id="panelContainer" style="display:none;">
  <h2>Admin Panel</h2>
  <button id="logoutBtn">Logout</button>
  <table>
    <thead>
      <tr>
        <th>Nama</th>
        <th>Phone</th>
        <th>Lokasi</th>
        <th>Email</th>
        <th>Waktu</th>
      </tr>
    </thead>
    <tbody id="dataTable"></tbody>
  </table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAyCvKdrd0_EdqTg3EZgkbmeQQvAhn172Y",
  authDomain: "absenneoform.firebaseapp.com",
  databaseURL: "https://absenneoform-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "absenneoform",
  storageBucket: "absenneoform.appspot.com",
  messagingSenderId: "802007314176",
  appId: "1:802007314176:web:5cea26b50761a0dccc0de5"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const loginContainer = document.getElementById("loginContainer");
const panelContainer = document.getElementById("panelContainer");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const passwordInput = document.getElementById("adminPassword");
const dataTable = document.getElementById("dataTable");

const ADMIN_PASSWORD = "admin123"; // ganti sesuai password kamu

if(localStorage.getItem("adminLoggedIn") === "true"){
  loginContainer.style.display = "none";
  panelContainer.style.display = "block";
  loadData();
}

loginBtn.addEventListener("click",()=>{
  if(passwordInput.value === ADMIN_PASSWORD){
    localStorage.setItem("adminLoggedIn","true");
    loginContainer.style.display = "none";
    panelContainer.style.display = "block";
    loadData();
  }else{
    alert("Password salah!");
  }
});

logoutBtn.addEventListener("click",()=>{
  localStorage.removeItem("adminLoggedIn");
  panelContainer.style.display = "none";
  loginContainer.style.display = "block";
  passwordInput.value = "";
});

function loadData(){
  const dataRef = ref(db,"FormData");
  onValue(dataRef,(snapshot)=>{
    dataTable.innerHTML="";
    snapshot.forEach(childSnap=>{
      const data = childSnap.val();
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${data.Nama || ""}</td>
        <td>${data.Pesan || ""}</td>
        <td>${data.Lokasi || ""}</td>
        <td>${data.Inti || ""}</td>
        <td>${data.timestamp ? new Date(data.timestamp).toLocaleString() : ""}</td>
      `;
      dataTable.appendChild(row);
    });
  });
}
</script>
</body>
</html>
