<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Poppins',sans-serif;
  min-height:100vh;
  background:linear-gradient(270deg,#6f00ff,#c800ff,#6c63ff,#3498db);
  background-size:800% 800%;
  animation:gradientBG 25s ease infinite;
  color:#fff;
}
@keyframes gradientBG{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.container{
  max-width:900px;
  margin:40px auto;
  background:rgba(0,0,0,0.85);
  border-radius:20px;
  padding:30px;
  box-shadow:0 20px 50px rgba(0,0,0,0.7);
}

h2{
  text-align:center;
  margin-bottom:20px;
  text-shadow:0 0 15px #6c63ff,0 0 25px #ff00ff;
}

input,button{
  width:100%;
  padding:14px;
  margin-bottom:15px;
  border-radius:12px;
  border:none;
  font-size:16px;
}
input{
  background:rgba(0,0,0,0.3);
  color:#fff;
  border:2px solid #6c63ff;
}
button{
  background:linear-gradient(90deg,#6c63ff,#ff00ff,#6c63ff);
  color:#fff;
  cursor:pointer;
}
button:hover{box-shadow:0 0 20px #ff00ff;}

.logout{background:#ff4444;}

.table-wrap{overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.2);}
th{color:#ffccff;}
.small{font-size:13px;opacity:0.85;}

.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.popup-box{
  background:#111;
  padding:30px;
  border-radius:16px;
  text-align:center;
  box-shadow:0 0 30px #ff00ff;
  animation:popupIn 0.4s ease;
}
@keyframes popupIn{
  from{transform:scale(0.7);opacity:0;}
  to{transform:scale(1);opacity:1;}
}
.popup-box h3{margin-bottom:10px;color:#ff66ff;}
.popup-box button{margin-top:15px;}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <h2>Admin Login</h2>
  <input type="password" id="adminPass" placeholder="Password admin">
  <button onclick="login()">Login</button>
</div>

<!-- ADMIN -->
<div class="container" id="adminBox" style="display:none;">
  <h2>Data Absen</h2>
  <button class="logout" onclick="logout()">Logout</button>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Nama</th>
          <th>Phone</th>
          <th>Number</th>
          <th>Email</th>
          <th>Waktu</th>
        </tr>
      </thead>
      <tbody id="dataBody"></tbody>
    </table>
  </div>
</div>

<!-- ðŸ”¥ POPUP HTML -->
<div class="popup" id="errorPopup">
  <div class="popup-box">
    <h3>Password Salah</h3>
    <p>Coba lagi ya.</p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyAyCvKdrd0_EdqTg3EZgkbmeQQvAhn172Y",
  authDomain: "absenneoform.firebaseapp.com",
  databaseURL: "https://absenneoform-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "absenneoform",
  storageBucket: "absenneoform.appspot.com",
  messagingSenderId: "802007314176",
  appId: "1:802007314176:web:5cea26b50761a0dccc0de5"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* LOGIN */
const ADMIN_PASSWORD="@adminmode#2468$_'@";
const loginBox=document.getElementById("loginBox");
const adminBox=document.getElementById("adminBox");
const tbody=document.getElementById("dataBody");
const popup=document.getElementById("errorPopup");

function showPopup(){popup.style.display="flex";}
function closePopup(){popup.style.display="none";}

function checkLogin(){
  if(localStorage.getItem("adminLogin")==="true"){
    loginBox.style.display="none";
    adminBox.style.display="block";
    loadData();
  }
}

function login(){
  const pass=document.getElementById("adminPass").value;
  if(pass===ADMIN_PASSWORD){
    localStorage.setItem("adminLogin","true");
    checkLogin();
  }else{
    showPopup();
  }
}

function logout(){
  localStorage.removeItem("adminLogin");
  location.reload();
}

window.login=login;
window.logout=logout;
window.closePopup=closePopup;

/* DATA */
function loadData(){
  const dataRef=ref(db,"FormData");
  onValue(dataRef,(snap)=>{
    tbody.innerHTML="";
    if(!snap.exists())return;
    snap.forEach(c=>{
      const d=c.val();
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${d.Nama||"-"}</td>
        <td>${d.Pesan||"-"}</td>
        <td>${d.Lokasi||"-"}</td>
        <td>${d.Inti||"-"}</td>
        <td class="small">${new Date(d.timestamp).toLocaleString("id-ID")}</td>
      `;
      tbody.appendChild(tr);
    });
  });
}

checkLogin();
</script>

</body>
</html>
